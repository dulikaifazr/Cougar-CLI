/**
 * 🔧 新任务工具定义
 * 来源: 提示词/系统提示词/工具定义（19个工具）/新任务工具定义.ts
 * 
 * 作用：在超出令牌限制前创建新任务并保存上下文
 * 
 * 参数：
 * - context：详细的上下文信息，包括：
 *   - 当前工作
 *   - 关键技术概念
 *   - 相关文件和代码
 *   - 问题解决过程
 *   - 待处理任务和下一步
 * 
 * 用途：实现跨对话的任务延续
 * 
 * CLI 适配：100% 保留核心功能
 */

import { ModelFamily, ClineDefaultTool, type ClineToolSpec } from './types';

const id = ClineDefaultTool.NEW_TASK;

const generic: ClineToolSpec = {
  variant: ModelFamily.GENERIC,
  id,
  name: 'new_task',
  description: `请求创建一个新任务，其中包含预加载的上下文，涵盖到目前为止与用户的对话以及继续新任务的关键信息。使用此工具，您将创建到目前为止对话的详细摘要，密切关注用户的明确请求和您之前的操作，重点关注新任务所需的最相关信息。
在其他重要的关注领域中，此摘要应彻底捕获技术细节、代码模式和架构决策，这些对于继续新任务至关重要。用户将看到您生成的上下文的预览，可以选择创建新任务或在当前对话中继续聊天。用户可以在任何时候选择开始新任务。`,
  parameters: [
    {
      name: 'context',
      required: true,
      instruction: `预加载新任务的上下文。如果适用于当前任务，这应包括:
  1. 当前工作: 详细描述在请求创建新任务之前正在进行的工作。特别注意最近的消息/对话。
  2. 关键技术概念: 列出所有重要的技术概念、技术、编码约定和框架，这些可能与新任务相关。
  3. 相关文件和代码: 如果适用，列举为任务延续而检查、修改或创建的特定文件和代码部分。特别注意最近的消息和更改。
  4. 问题解决: 记录到目前为止解决的问题以及任何正在进行的故障排除工作。
  5. 待处理任务和后续步骤: 概述您已被明确要求处理的所有待处理任务，以及列出您将为所有未完成的工作采取的后续步骤（如果适用）。在添加清晰度的地方包含代码片段。对于任何后续步骤，包括最近对话的直接引用，准确显示您正在处理的任务以及您停下的位置。这应该是逐字逐句的，以确保任务之间的上下文中没有信息丢失。在这里要详细是很重要的。`,
      usage: '预加载新任务的上下文',
    },
  ],
};

export const new_task_variants = [generic];